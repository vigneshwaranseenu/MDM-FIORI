(()=>{"use strict";var e={d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{init:()=>h});const n="post-message-action";function i(e,t){function i(){return"function"==typeof e?e():e}function o(e){const o=i();var r;o&&e.origin===o.origin&&e.source===o&&((r=e.data).type===n&&"object"==typeof r.action?t(e.data.action):console.warn("Unknown message received",e.data))}return window.addEventListener("message",o),{dispose:function(){window.removeEventListener("message",o)},sendAction:function(e){const t=i();if(!t)return;const o={type:n,action:e};t.postMessage(o,t.origin)}}}const o="string",r="input";const a=(s="[ext]",function(e){const t=[s,e].join(" ");function n(e){return{type:t,payload:e}}var i;return n.type=t,n.match=(i=t,function(e){return(null==e?void 0:e.type)===i}),n});var s;const c=a("control-selected"),l=a("select-control"),u=a("outline-changed"),p=a("change-property");function d(e){const t={primitiveType:"any",ui5Type:null,enumValues:null,isArray:!1};if(!e)return;const n=e.getType();if(!n)return;const i=n.getName();if(i){if(i.indexOf("[]")>0)t.primitiveType=i.substring(0,i.indexOf("[]")),t.isArray=!0;else if("void"===i||"object"===i)t.primitiveType=i;else if("any"===i)t.primitiveType="any";else if("boolean"===i||"string"===i||"int"===i||"float"===i)t.primitiveType=i;else{const e=window.sap.ui.base.DataType,n=e.getType(i);if(n&&!(n instanceof e))return t;Object.getPrototypeOf(n).getName()?t.primitiveType=Object.getPrototypeOf(n).getName():t.primitiveType="enum",t.ui5Type=i,"enum"===t.primitiveType&&(t.enumValues=jQuery.sap.getObject(t.ui5Type))}return t}}function y(e){return!e.isArray&&"any"!==e.primitiveType}function g(e){if(!("object"==typeof e&&e instanceof Object)||Array.isArray(e))return"function"==typeof e?"":e;try{return JSON.stringify(e)}catch(t){return t instanceof Error&&t.message.toLowerCase().includes("converting circular structure to json")?"<Circular JSON cannot be displayed>":e}}function f(e,t){var n,i;const a=e.getMetadata(),s=a.getName(),c=sap.ui.fl.Utils.checkControlId(e),l=t?t.getDesignTimeMetadata().getData().properties:void 0,u=a.getAllProperties(),p=Object.keys(u),f=[];for(const a of p){const s=u[a],p=d(s);if(!p)continue;let m=!1;l&&l[s.name]&&(m=l[s.name].ignore);const v={id:e.getId(),name:s.name,newValue:e.getProperty(s.name)},b=e.getBindingInfo(v.name);void 0!==(null==b?void 0:b.bindingString)&&(v.newValue=b.bindingString);const h=null!==(n=null==t?void 0:t.isSelectable())&&void 0!==n&&n&&y(p)&&c&&!m,w=g(v.newValue);switch(p.primitiveType){case"enum":if("string"==typeof w){const e=null!==(i=p.enumValues)&&void 0!==i?i:{},t=Object.keys(e).map((t=>({key:t,text:e[t]})));f.push({type:o,editor:"dropdown",name:s.name,value:w,isEnabled:h,options:t})}break;case"string":"string"==typeof w&&f.push({type:o,editor:r,name:s.name,value:w,isEnabled:h});break;case"float":"number"==typeof w&&f.push({type:"number",editor:r,name:s.name,value:w,isEnabled:h});break;case"boolean":"boolean"==typeof w&&f.push({type:"boolean",editor:"checkbox",name:s.name,value:w,isEnabled:h})}}return{id:e.getId(),type:s,properties:f.sort(((e,t)=>e.name>t.name?1:-1))}}function m(e){return!(!e.startsWith("{")||!e.endsWith("}"))}function v(e,t){var n,i,o,r;const a=[...e],s=[];for(;a.length;){const e=a.shift();if("element"===(null==e?void 0:e.type)){const a=(null!==(n=e.elements)&&void 0!==n?n:[]).flatMap((e=>{var t;return"aggregation"===e.type&&null!==(t=e.elements)&&void 0!==t?t:[]})),c={controlId:e.id,controlType:e.technicalName,name:null!==(i=t(e.id))&&void 0!==i?i:e.technicalName.split(".").slice(-1)[0],editable:null!==(o=e.editable)&&void 0!==o&&o,visible:null===(r=e.visible)||void 0===r||r,children:v(a,t)};s.push(c)}}return s}async function b(e,t){const n=await e.getService("outline");n.attachEvent("update",(async function(){const e=v(await n.get(),(e=>{const t=sap.ui.getCore().byId(e);if(t&&t.getMetadata().getProperty("text")){const e=t.getProperty("text");if("string"==typeof e&&""!==e.trim())return e}}));t(u(e))}))}function h(e){console.log("Initializing Control Property Editor");const{rta:t}=e;try{const{sendAction:n}=i(window.parent,(async function(i){if(p.match(i))await async function(e,t){const{layer:n,componentId:i,rta:o,generator:r}=e,a=sap.ui.getCore().byId(t.controlId);if(!a)return;const s={layer:n,developerMode:!0,baseId:i,projectId:"",scenario:"FE_FROM_SCRATCH"},c="string"==typeof t.value&&m(t.value)?"BindProperty":"Property",l="string"==typeof t.value&&m(t.value)?{propertyName:t.propertyName,newBinding:t.value}:{propertyName:t.propertyName,newValue:t.value},u=await sap.ui.rta.command.CommandFactory.getCommandFor(a,c,l,null,s);u.getPreparedChange().getDefinition().support.generator=r,await o.getCommandStack().pushAndExecute(u)}(e,i.payload);else if(l.match(i)){const e=i.payload,o=sap.ui.getCore().byId(e);if(!o)return;let r=sap.ui.dt.OverlayRegistry.getOverlay(o);const a=t.getSelection();if(a.length>0)for(let e=0;e<a.length;e++)a[e].setSelected(!1);if(r&&r.getDomRef()||(r=sap.ui.dt.OverlayUtil.getClosestOverlayFor(o)),r&&r.isSelectable())r.setSelected(!0);else{const e=f(o),t=c(e);n(t)}}}));t.attachSelectionChange(function(e){return function(t){const n=t.getParameter("selection");if(Array.isArray(n)&&1===n.length){const t=sap.ui.getCore().byId(n[0].getId());if(t){const n=f(t.getElementInstance(),t),i=c(n);e(i)}}}}(n)),b(t,n)}catch(e){console.error("Error during initialization of Control Property Editor",e)}}self["ui5-adaptation"]=t})();